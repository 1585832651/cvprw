2024-02-14 00:41:24,869 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Current SDK version is 0.16.3
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Configure stats pid to 124389
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Loading settings from /root/autodl-tmp/CVHSSR/wandb/settings
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'basicsr/train.py', 'program_abspath': '/root/autodl-tmp/CVHSSR/basicsr/train.py', 'program': 'basicsr/train.py'}
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:_log_setup():526] Logging user logs to /root/autodl-tmp/CVHSSR/wandb/run-20240214_004124-ltrbr4la/logs/debug.log
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:_log_setup():527] Logging internal logs to /root/autodl-tmp/CVHSSR/wandb/run-20240214_004124-ltrbr4la/logs/debug-internal.log
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:init():566] calling init triggers
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:init():573] wandb.init called with sweep_config: {}
config: {'name': 'CVHSSR-T_x4_baseline', 'model_type': 'ImageRestorationModel', 'scale': 4, 'num_gpu': 1, 'manual_seed': 10, 'datasets': OrderedDict([('train', OrderedDict([('name', 'Flickr1024-sr-train'), ('type', 'PairedStereoImageDataset'), ('dataroot_gt', './dataset/Train/HR'), ('dataroot_lq', './dataset/Train/LR_x4'), ('io_backend', OrderedDict([('type', 'disk')])), ('gt_size_h', 120), ('gt_size_w', 360), ('use_hflip', True), ('use_vflip', True), ('use_rot', False), ('flip_RGB', True), ('use_shuffle', True), ('num_worker_per_gpu', 8), ('batch_size_per_gpu', 12), ('dataset_enlarge_ratio', 1), ('prefetch_mode', None), ('phase', 'train'), ('scale', 4)])), ('val', OrderedDict([('name', 'Flickr1024-sr-test'), ('type', 'PairedStereoImageDataset'), ('dataroot_gt', './dataset/val/HR'), ('dataroot_lq', './dataset/val/LR_x4'), ('io_backend', OrderedDict([('type', 'disk')])), ('phase', 'val'), ('scale', 4)]))]), 'network_g': OrderedDict([('type', 'CVHSSR'), ('up_scale', 4), ('width', 48), ('num_blks', 16), ('drop_path_rate', 0), ('train_size', [1, 6, 30, 90]), ('drop_out_rate', 0.0)]), 'path': OrderedDict([('pretrain_network_g', None), ('strict_load_g', True), ('resume_state', None), ('root', '/root/autodl-tmp/CVHSSR'), ('experiments_root', '/root/autodl-tmp/CVHSSR/experiments/CVHSSR-T_x4_baseline'), ('models', '/root/autodl-tmp/CVHSSR/experiments/CVHSSR-T_x4_baseline/models'), ('training_states', '/root/autodl-tmp/CVHSSR/experiments/CVHSSR-T_x4_baseline/training_states'), ('log', '/root/autodl-tmp/CVHSSR/experiments/CVHSSR-T_x4_baseline'), ('visualization', '/root/autodl-tmp/CVHSSR/experiments/CVHSSR-T_x4_baseline/visualization')]), 'train': OrderedDict([('optim_g', OrderedDict([('type', 'Lion'), ('lr', 0.0001), ('weight_decay', 0.0), ('betas', [0.9, 0.9])])), ('scheduler', OrderedDict([('type', 'TrueCosineAnnealingLR'), ('T_max', 200000), ('eta_min', 1e-08)])), ('total_iter', 200000), ('warmup_iter', -1), ('mixup', False), ('pixel_opt', OrderedDict([('type', 'ComposeLoss'), ('loss_weight', 0.01), ('reduction', 'mean')]))]), 'val': OrderedDict([('val_freq', 10000.0), ('save_img', False), ('trans_num', 1), ('max_minibatch', 1), ('metrics', OrderedDict([('psnr', OrderedDict([('type', 'calculate_psnr'), ('crop_border', 0), ('test_y_channel', False)])), ('ssim', OrderedDict([('type', 'calculate_skimage_ssim')]))]))]), 'logger': OrderedDict([('print_freq', 200), ('save_checkpoint_freq', 10000.0), ('use_tb_logger', True), ('wandb', OrderedDict([('project', 'CVHSSR_T_baseline'), ('resume_id', None)]))]), 'dist_params': OrderedDict([('backend', 'nccl'), ('port', 29500)]), 'is_train': True, 'dist': True, 'rank': 0, 'world_size': 2}
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:init():616] starting backend
2024-02-14 00:41:24,870 INFO    MainThread:124389 [wandb_init.py:init():620] setting up manager
2024-02-14 00:41:24,871 INFO    MainThread:124389 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-02-14 00:41:24,872 INFO    MainThread:124389 [wandb_init.py:init():628] backend started and connected
2024-02-14 00:41:24,875 INFO    MainThread:124389 [wandb_init.py:init():720] updated telemetry
2024-02-14 00:41:24,893 INFO    MainThread:124389 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-02-14 00:41:26,624 INFO    MainThread:124389 [wandb_run.py:_on_init():2262] communicating current version
2024-02-14 00:41:27,932 INFO    MainThread:124389 [wandb_run.py:_on_init():2271] got version response 
2024-02-14 00:41:27,932 INFO    MainThread:124389 [wandb_init.py:init():804] starting run threads in backend
2024-02-14 00:41:28,556 INFO    MainThread:124389 [wandb_run.py:_console_start():2241] atexit reg
2024-02-14 00:41:28,556 INFO    MainThread:124389 [wandb_run.py:_redirect():2096] redirect: wrap_raw
2024-02-14 00:41:28,556 INFO    MainThread:124389 [wandb_run.py:_redirect():2161] Wrapping output streams.
2024-02-14 00:41:28,556 INFO    MainThread:124389 [wandb_run.py:_redirect():2186] Redirects installed.
2024-02-14 00:41:28,557 INFO    MainThread:124389 [wandb_init.py:init():847] run started, returning control to user process
2024-02-14 00:41:28,558 INFO    MainThread:124389 [wandb_run.py:_tensorboard_callback():1499] tensorboard callback: logs/CVHSSR-T_x4_baseline, True
